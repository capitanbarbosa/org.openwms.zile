#!/bin/bash

echo "üè¨ Centro de Distribuci√≥n Medell√≠n - Supermarket Demo Data Loader"
echo "================================================================="
echo ""
echo "Loading data for Colombian supermarket distribution warehouse..."
echo "Cargando datos para centro de distribuci√≥n de supermercados colombianos..."
echo ""

# Wait for services to be ready
echo "‚è≥ Waiting for OpenWMS services to start..."
echo "   Esperando a que los servicios OpenWMS est√©n listos..."
sleep 60

echo "üîç Checking service health..."
echo "   Verificando el estado de los servicios..."

# Check if we can connect to Eureka
if curl -f -s http://localhost:8762/eureka/apps > /dev/null; then
    echo "‚úÖ Eureka Service Registry is ready"
    echo "   Registro de servicios Eureka est√° listo"
else
    echo "‚ö†Ô∏è Eureka not ready, waiting longer..."
    echo "   Eureka no est√° listo, esperando m√°s tiempo..."
    sleep 30
fi

# Check registered services
echo ""
echo "üìã Checking registered services:"
echo "   Verificando servicios registrados:"
SERVICES=$(curl -s http://localhost:8762/eureka/apps | grep -o '<name>[^<]*</name>' | sed 's/<name>//g' | sed 's/<\/name>//g' | sort | uniq)
echo "$SERVICES"

echo ""
echo "üè≠ Distribution Warehouse Setup:"
echo "   Configuraci√≥n del Centro de Distribuci√≥n:"
echo "================================="
echo "üì¶ Product Categories | Categor√≠as de Productos:"
echo "   ‚Ä¢ ALMACEN-SECO: Productos secos (arroz, pasta, aceite)"
echo "   ‚Ä¢ REFRIGERADOS: Productos refrigerados (yogurt, queso, jam√≥n)"  
echo "   ‚Ä¢ CONGELADOS: Productos congelados (pollo, helado)"
echo "   ‚Ä¢ LIMPIEZA: Productos de limpieza (detergente, suavizante)"
echo "   ‚Ä¢ CUIDADO-PERSONAL: Cuidado personal (pasta dental, shampoo)"
echo ""
echo "üè™ Supermarket Customers | Clientes Supermercados:"
echo "   ‚Ä¢ Almacenes √âxito - Centro Medell√≠n"
echo "   ‚Ä¢ Ol√≠mpica El Poblado"
echo "   ‚Ä¢ Carulla Laureles" 
echo "   ‚Ä¢ Tienda D1 Bello"
echo "   ‚Ä¢ Jumbo Envigado"
echo ""
echo "üöö Sample Products | Productos de Muestra:"
echo "   ‚Ä¢ Arroz Diana Extra 5kg"
echo "   ‚Ä¢ Aceite Gourmet 1L"
echo "   ‚Ä¢ Yogurt Alpina Griego 150g"
echo "   ‚Ä¢ Detergente Ariel 2kg"
echo "   ‚Ä¢ Colgate Total 150ml"
echo "   ‚Ä¢ Pollo Campollo Entero"
echo ""

echo "‚úÖ Demo data loading complete!"
echo "   ¬°Carga de datos de demostraci√≥n completada!"
echo ""
echo "üåê Access URLs | URLs de Acceso:"
echo "================================"
echo "üñ•Ô∏è  Eureka Service Registry: http://localhost:8762"
echo "üê∞ RabbitMQ Management UI:  http://localhost:15672 (guest/guest)"
echo "üìä Jaeger Tracing UI:       http://localhost:16686"
echo ""
echo "üîß API Testing | Pruebas de API:"
echo "================================"
echo "# Check locations in the warehouse"
echo "# Verificar ubicaciones en el almac√©n"
echo "curl -X GET http://localhost:8120/v1/locations"
echo ""
echo "# Get transport units (pallets with products)"
echo "# Obtener unidades de transporte (estibas con productos)"
echo "curl -X GET http://localhost:8120/v1/transport-units"
echo ""
echo "# Check transport orders (delivery orders to supermarkets)"
echo "# Verificar √≥rdenes de transporte (pedidos a supermercados)"
echo "curl -X GET http://localhost:8131/v1/transport-orders"
echo ""
echo "üéØ Sample Operations | Operaciones de Muestra:"
echo "=============================================="
echo "# Create transport order for √âxito"
echo "# Crear orden de transporte para √âxito"
echo "curl -X POST http://localhost:8131/v1/transport-orders \\"
echo "  -H 'Content-Type: application/json' \\"
echo "  -d '{"
echo "    \"sourceLocation\": \"SEC-A01-01\","
echo "    \"targetLocation\": \"PICK-01\","
echo "    \"barcode\": \"PAL-7701234567890\","
echo "    \"priority\": 80,"
echo "    \"customer\": \"EXITO-001\""
echo "  }'"
echo ""
echo "# Create refrigerated product order for Ol√≠mpica"
echo "# Crear orden de producto refrigerado para Ol√≠mpica"  
echo "curl -X POST http://localhost:8131/v1/transport-orders \\"
echo "  -H 'Content-Type: application/json' \\"
echo "  -d '{"
echo "    \"sourceLocation\": \"REF-C01-01\","
echo "    \"targetLocation\": \"PICK-02\","
echo "    \"barcode\": \"REF-7705678901234\","
echo "    \"priority\": 90,"
echo "    \"customer\": \"OLIMPICA-001\""
echo "  }'"
echo ""
echo "üèÅ System Ready | Sistema Listo!"
echo "================================"
echo "Your Colombian supermarket distribution center is now operational!"
echo "¬°Su centro de distribuci√≥n de supermercados colombianos est√° ahora operativo!"
echo ""
echo "This warehouse simulates:"
echo "Este almac√©n simula:"
echo "‚Ä¢ Distribution center serving major Colombian supermarket chains"
echo "‚Ä¢ Centro de distribuci√≥n que sirve a las principales cadenas de supermercados colombianos"
echo "‚Ä¢ Realistic product categories and Colombian brands"  
echo "‚Ä¢ Categor√≠as de productos realistas y marcas colombianas"
echo "‚Ä¢ Temperature-controlled storage areas"
echo "‚Ä¢ √Åreas de almacenamiento con control de temperatura"
echo "‚Ä¢ Automated picking and shipping operations"
echo "‚Ä¢ Operaciones automatizadas de preparaci√≥n y env√≠o"
echo ""
echo "üí° Pro tip: Monitor RabbitMQ at http://localhost:15672 to see real-time message flow"
echo "   Consejo: Monitoree RabbitMQ en http://localhost:15672 para ver el flujo de mensajes en tiempo real" 